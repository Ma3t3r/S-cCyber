import nessus
import time

def scan_domain(domain):
    scanner = nessus.Scanner(
        url="https://nessus.example.com",
        username="username",
        password="password",
        insecure=True,
        debug=False
    )

    scan = scanner.scan_new(
        name=domain,
        targets=domain,
        policy_id=1,
        options={
            "scanner_id": 1,
            "text_targets": domain,
            "custom_targets": domain,
            "launch_now": True,
        }
    )
    scan_id = scan["scan"]["id"]
    print("Started scan for", domain, "with ID", scan_id)
    while True:
        progress = scanner.scan_status(scan_id)
        if progress["progress"] == "100":
            break
        time.sleep(5)
    report = scanner.download_report(scan_id, report_format="pdf")
    with open("scan-report.pdf", "wb") as f:
        f.write(report)
    print("Scan completed, report saved as scan-report.pdf")

domain = input("Enter the website to test: ")
scan_domain(domain)
