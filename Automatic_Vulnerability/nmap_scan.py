import nmap

def scan(ips_or_domains):
    nm = nmap.PortScanner()
    for ip_or_domain in ips_or_domains:
        nm.scan(ip_or_domain, arguments="-sV")
        for host in nm.all_hosts():
            print("Host: %s (%s)" % (host, nm[host].hostname()))
            for proto in nm[host].all_protocols():
                print("Protocol: %s" % proto)
                lport = nm[host][proto].keys()
                for port in lport:
                    print("Port: %s\tState: %s\tService: %s" % (port, nm[host][proto][port]["state"], nm[host][proto][port]["name"]))

ips_or_domains = []
while True:
    ip_or_domain = input("Enter IP or domain (or enter to finish): ")
    if ip_or_domain == "":
        break
    ips_or_domains.append(ip_or_domain)
scan(ips_or_domains)
